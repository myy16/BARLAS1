#------------------------------------------------------------
# TEKNOFEST RBPF-SLAM Configuration
# my_robot grid_slam_demo.ini'den teknofest için adapte edildi
# TEKNOFEST araç boyutları ve parkur için optimize edildi
#------------------------------------------------------------

#=======================================================
# Section: [MappingApplication]
# Global parameters for TEKNOFEST application
#=======================================================
[MappingApplication]
CAMERA_3DSCENE_FOLLOWS_ROBOT=1    # Robot takibi aktif
SHOW_PROGRESS_IN_WINDOW=1         # Progress window göster

# Insertion thresholds - TEKNOFEST parkuru için optimize
insertionLinDistance=0.25         # 25cm linear distance threshold
insertionAngDistance_deg=15.0     # 15° angular distance threshold

# Localization thresholds - TEKNOFEST için optimize
localizeLinDistance=0.6           # 60cm localization distance
localizeAngDistance_deg=20.0      # 20° localization angle

# Motion model settings
use_motion_model_default_options=0  # Custom motion model

#----------------------------------------------------------------------------------
# Particle Filter Algorithm - TEKNOFEST için optimize
# 2: pfOptimalProposal - ICP tabanlı, odometry ile uyumlu
#----------------------------------------------------------------------------------
PF_algorithm=2
adaptiveSampleSize=0              # Sabit parçacık sayısı

#----------------------------------------------------------------------------------
# Resampling Method - TEKNOFEST için en iyi performans
# 3: prSystematic - systematic resampling
#----------------------------------------------------------------------------------
resamplingMethod=3

sampleSize=200                    # TEKNOFEST için artırılmış parçacık sayısı
BETA=0.45                        # Resampling threshold (daha hassas)
max_loglikelihood_dyn_range=30   # Geniş likelihood range

# ========================================================
# MULTIMETRIC MAP CONFIGURATION - TEKNOFEST için
# ========================================================
occupancyGrid_count=1             # Occupancy grid kullan
gasGrid_count=0                   # Gas grid kullanma
landmarksMap_count=0              # Landmark map kullanma  
beaconMap_count=0                 # Beacon map kullanma
pointsMap_count=0                 # Points map kullanma

#----------------------------------------------------------------------------------
# Creation of maps - TEKNOFEST parkuru için boyutlar
#----------------------------------------------------------------------------------
[MappingApplication_occupancyGrid_00_creationOpts]
resolution=0.04                   # 4cm çözünürlük (yüksek hassasiyet)
max_x=75.0                       # +75m
min_x=-75.0                      # -75m  
max_y=75.0                       # +75m
min_y=-75.0                      # -75m (150x150m toplam alan)

#----------------------------------------------------------------------------------
# Insertion options - TEKNOFEST LiDAR için optimize
#----------------------------------------------------------------------------------
[MappingApplication_occupancyGrid_00_insertOpts]
maxDistanceInsertion=25.0        # 25m maximum insertion distance
maxOccupancyUpdateCertainty=0.65 # %65 certainty

# TEKNOFEST için probability values
prob_hit=0.82                    # Hit probability
prob_miss=0.48                   # Miss probability

# LiDAR filtering - YDLidar için optimize
CFD_features_gaussian_size=2.0   # Gaussian filter size
CFD_features_median_size=3.0     # Median filter size

# Invalid range handling
removeInvalidRangesFromLaser=1   # Invalid range'leri kaldır
considerInvalidRangesAsFreeSpace=1

# TEKNOFEST specific thresholds
thresholdForOccupancy=0.65       # Occupied threshold %65
thresholdForFree=0.35            # Free threshold %35

# Decimation for performance
decimation=1                     # Her LiDAR noktasını kullan (hassasiyet için)

#----------------------------------------------------------------------------------
# Likelihood options - TEKNOFEST için optimize
#----------------------------------------------------------------------------------
[MappingApplication_occupancyGrid_00_likelihoodOpts]
likelihoodMethod=4               # LF_THRUN_MODEL - en iyi performans

# Sensor model parameters - YDLidar X4 Pro için
LF_stdHit=0.03                  # 3cm std hit
LF_zHit=0.85                    # Hit weight
LF_zRandom=0.05                 # Random weight  
LF_zMax=0.02                    # Max range weight
LF_zShort=0.08                  # Short reading weight
LF_zShortSigma=0.02             # Short reading sigma

# Maximum range considerations
LF_maxRange=10.0                # 10m max range (YDLidar spec)

#----------------------------------------------------------------------------------
# Motion Model - TEKNOFEST araç için optimize
#----------------------------------------------------------------------------------
[DummyOdometryParams]
# Motion model type
modelSelection=1                # Thrun motion model

# TEKNOFEST araç boyutları için noise parametreleri
alfa1_rot_rot=0.15             # Rotation -> rotation error
alfa2_rot_trans=0.12           # Rotation -> translation error  
alfa3_trans_trans=0.08         # Translation -> translation error
alfa4_trans_rot=0.14           # Translation -> rotation error

# Minimum standard deviations - TEKNOFEST için
minStdXY=0.03                  # 3cm minimum XY std
minStdPHI=0.025                # 0.025 rad minimum orientation std

# Additional noise for robustness
additional_std_XY=0.05         # 5cm additional XY noise
additional_std_phi=0.04        # 0.04 rad additional orientation noise

#----------------------------------------------------------------------------------
# ICP (Iterative Closest Point) options - TEKNOFEST için
#----------------------------------------------------------------------------------
[ICP]
# ICP algorithm selection
ICP_algorithm=0                 # Classic ICP

# Convergence criteria - TEKNOFEST için optimize
maxIterations=50               # Maximum iterations
minAbsStep_trans=0.01          # 1cm translation threshold
minAbsStep_rot=0.005           # 0.005 rad rotation threshold

# Outlier rejection
thresholdDist=0.3              # 30cm outlier threshold
thresholdAng_DEG=15.0          # 15° angular threshold

# Covariance estimation
doRANSAC=1                     # RANSAC outlier removal
ransac_minSetSize=3            # Minimum RANSAC set size
ransac_maxSetSize=20           # Maximum RANSAC set size
ransac_mahalanobisDistanceThreshold=3.0

# Performance options
corresponding_points_decimation=3  # Correspondence decimation
onlyClosestCorrespondences=1   # Only closest correspondences
onlyUniqueRobust=0            # Unique robust matches

#----------------------------------------------------------------------------------
# Sensor pose on robot - TEKNOFEST mount position
#----------------------------------------------------------------------------------
[LaserPoseOnTheRobot]
# LiDAR mounting position (center-front of robot)
pose_x=0.15                    # 15cm forward from center
pose_y=0.00                    # Center line
pose_z=0.08                    # 8cm above base
pose_yaw_deg=0.0               # Forward facing
pose_pitch_deg=0.0             # Level
pose_roll_deg=0.0              # No roll

#----------------------------------------------------------------------------------
# TEKNOFEST specific parameters
#----------------------------------------------------------------------------------
[TEKNOFEST]
# Mission parameters
max_mission_time=900           # 15 minutes mission time
checkpoint_tolerance=1.0       # 1m checkpoint tolerance
obstacle_avoidance_distance=2.0 # 2m obstacle avoidance
emergency_stop_distance=0.5    # 50cm emergency stop

# Navigation parameters  
path_planning_resolution=0.2   # 20cm path resolution
goal_tolerance=0.4            # 40cm goal tolerance
max_velocity=2.5              # 2.5 m/s max velocity
max_angular_velocity=1.2      # 1.2 rad/s max angular velocity

# Safety parameters
max_acceleration=2.0          # 2.0 m/s² max acceleration
max_slope_angle=25.0          # 25° max slope angle
collision_threshold=0.3       # 30cm collision threshold

#----------------------------------------------------------------------------------
# Logging and debug options
#----------------------------------------------------------------------------------
[Logging]
log_level=INFO                # Logging level
save_simplemap=1              # Save simplemap
simplemap_save_period=300     # 5 minutes save period
log_particles=0               # Don't log particles (performance)
log_likelihood=0              # Don't log likelihood (performance)

#----------------------------------------------------------------------------------
# Performance tuning
#----------------------------------------------------------------------------------  
[Performance]
use_multithreading=1          # Enable multithreading
max_cpu_usage=75              # 75% max CPU usage
memory_limit_mb=2048          # 2GB memory limit
map_update_rate=10            # 10Hz map update rate
